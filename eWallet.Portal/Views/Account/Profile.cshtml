@using eWallet.Portal.Models
@model dynamic
@{
    ViewBag.Title = "Thông tin cá nhân";
    Layout = null;
}
<ul class="breadcrumb">
    <li><a href='@Url.Content("/Home/Index")' class="glyphicons home"><i></i> eWallet</a></li>
    <li>Thông tin cá nhân</li>
</ul>
<div class="separator"></div>
<div id="login-dp" class="content-dp">
    <div class="col-md-6">
        <div class="form" role="form">
            <div class="form-group">
                <label class="sr-only" for="full_name">Họ và tên</label>
                <input type="text" class="form-control" id="full_name" value="@ViewBag.profile.full_name" placeholder="Họ và tên" readonly>
            </div>
            <div class="form-group">
                <label class="sr-only" for="email">Địa chỉ email</label>
                <input type="email" class="form-control" id="email" placeholder="Email address" value="@ViewBag.profile.user_name" readonly>
            </div>
            <div class="form-group">
                <label class="sr-only" for="mobile">Số điện thoại di động</label>
                <input type="text" class="form-control" id="mobile" placeholder="Số điện thoại di động" value="@ViewBag.profile.mobile" readonly>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="form" role="form">
            <div class="form-group">
                <label class="sr-only" for="address">Địa chỉ</label>
                <input type="text" class="form-control" id="address" placeholder="Địa chỉ" value="@ViewBag.profile.address" required>
            </div>
            <div class="form-group">
                <label class="sr-only" for="personal_id">Số CMND</label>
                <input type="text" class="form-control" id="personal_id" onkeypress='validate(event)' placeholder="Số CMND" value="@ViewBag.profile.personal_id" required>
            </div>
            <div class="form-group">
                <label class="sr-only" for="personal_id_issued_date">Ngày cấp</label>
                <input type="date" class="form-control" id="personal_id_issued_date" placeholder="Ngày cấp" value="@ViewBag.profile.personal_id_issued_date" required>
            </div>
            <div class="form-group">
                <label class="sr-only" for="personal_id_issued_by">Nơi cấp</label>
                <input type="text" class="form-control" id="personal_id_issued_by" placeholder="Nơi cấp" value="@ViewBag.profile.personal_id_issued_by" required>
            </div>
        </div>
    </div>
    <div class="col-md-12">
        <div class="form-group">
            <button type="button" id="btn-update" class="btn btn-primary">Cập nhật</button>
            <a href='@Url.Action("Manage","Account",null,null)' class="btn btn-primary">Thiết lập mật khẩu</a>
        </div>
    </div>

</div>
<script>
    $('#btn-update').click(function () {
        //NProgress.start();
        $password = $('#password').val();
        $Address = $('#address').val();
        $personalid = $('#personal_id').val();
        $personalid_issueddate = $('#personal_id_issued_date').val();
        $personalid_issuedby = $('#personal_id_issued_by').val();

        $.ajax({
            url: '/Update/profile',
            contentType: 'application/json',
            type: 'GET',
            dataType: 'json',
            data: { password: $password, address: $Address, personalid: $personalid, personalid_issueddate: $personalid_issueddate, personalid_issuedby: $personalid_issuedby }
        })
                           .success(function (result) {
                               alert(result.error_message);
                               if (result.error_code == "00") {
                                   window.location = "Personal#profile";
                                   return;
                               }
                               else {
                                   alert(result.error_message);
                                   return;
                               }
                           })
                           .error(function (jqXHR, textStatus, errorThrown) {
                               return;
                           });
    });
</script>

@*kiểm tra kiểu số khi nhập*@
<script>
function validate(evt) {
    var theEvent = evt || window.event;
    var key = theEvent.keyCode || theEvent.which;
    key = String.fromCharCode(key);
    var regex = /[0-9]|\./;
    if (!regex.test(key)) {
        theEvent.returnValue = false;
        if (theEvent.preventDefault) theEvent.preventDefault();
    }
}
</script>